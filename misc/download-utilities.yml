versions:
  codeowners: 1.2.1
  crane: 0.20.7
  docker-buildx: 0.31.1
  docker-compose: 5.0.2
  download-utilities.sh: "3.8"
  gh: 2.86.0
  git-idm: 68c2ee1e406c2f2c72c8399e09564a970a025a0a
  gitleaks: 8.30.0
  goss: 0.4.9
  jq: 1.8.1
  kind: 0.31.0
  kubectl: 1.35.1
  saml2aws: 2.36.19
  shellcheck: 0.11.0
  woke: 0.19.0
  yq: 4.52.2
checksums:
  crane:
    Darwin:
      arm64: b0328c2c36d25415b0aac3b2cb24df8be8b19dfe787479a1db784e5063105f74
      x86_64: 2f01b1060df27beb9b443b28ae3f32dbe7cd91cfadf227605bd25b5417fd0ebf
    Linux:
      arm64: c35c622fdc915fbbfa004bb894803237ba3902c417114d9f168a6e40af1685ad
      x86_64: ffe4d4ec41f98975b4487164a94f02ea9c167269ea22aa5c4d8db45fd782a333
  docker-buildx:
    darwin:
      arm64: a354afe6a1ad3c639f8372d3b3e7ad83de6f85386115b82014a44c07c24c93df
      amd64: add7f9b18c4208af34c29a1f90318f302356fdc017a92b20c1966c3e14ddb3c4
    linux:
      arm64: 963c674c558dad2eefd42304a09020329a196ed16819b72396e7657eb69f031b
      amd64: dc8eaffbf29138123b4874d852522b12303c61246a5073fa0f025e4220317b1e
  docker-compose:
    darwin:
      aarch64: 72c7e684a1944cfb1765358d7ea7822cd209f25208ca235b914e761d9abb224e
      x86_64: 766d6f9b305d89c3b8fe88cb6fb207fd7f531fbd63982b6136d058c1f98767bd
    linux:
      aarch64: ac7810e0cd56a5b58576688196fafa843e07e8241fb91018a736d549ea20a3f3
      x86_64: 2d880f723d3da7c779c54fdaea91a842fca8af55d1397f1ed8d7cbab3dd7af67
  gh:
    macOS:
      arm64: 493b35ddb85f369ab2c86535b8b5e56fb0b4e07141c6eac7da1a091dd5946291
      amd64: af19aaeba35a6b36d2c65b9de6bfffcd2ee9c4f6d790ff9a40d4349c69c4caed
    linux:
      arm64: ddaf8e51406aba3d400a91487371967160c3c589368b0c4a74413a0f9591f2f6
      amd64: a599fc48d28ee94085bb6d127b5c56b9ac7479247087d575911bb7cdd8c598ea
  git-idm: d99592623838932190083cd1f2c8bc47af9f97e8fa4b6dab580c80830d4e2071
  gitleaks:
    darwin:
      arm64: 095bc4be1624239f52ebb90ff91668d1d3e78e0f8c5286e2d981887905c27561
      x64: f478677e8858ec3129153dec6e3f8dab5b5f674c120245e7878f89582444d06f
    linux:
      arm64: 3957ad3e168b6633307c1d8ea43bffa17557f825027504b13b574899212e635a
      x64: 8b6fd684fcd5b4ebe39b68abb072ce59e1063ce7ed4abd556157697845f1f088
  goss:
    darwin:
      arm64: 111d2ada89f8787838d176011de2fd0cfe8959c64c2698ce28feb587337d01fc
      amd64: e0c1b22360ced9f5394e64244877dfe1d3488aee9de75c56b9e02ae72c3fe4ff
    linux:
      arm64: 14fd24ac08236559f4809e6a627792d1b947ed98654bba1662ef1d6122d77e18
      amd64: 87dd36cfa1b8b50554e6e2ca29168272e26755b19ba5438341f7c66b36decc19
  jq:
    macos:
      arm64: a9fe3ea2f86dfc72f6728417521ec9067b343277152b114f4e98d8cb0e263603
      amd64: e80dbe0d2a2597e3c11c404f03337b981d74b4a8504b70586c354b7697a7c27f
    linux:
      arm64: 6bc62f25981328edd3cfcfe6fe51b073f2d7e7710d7ef7fcdac28d4e384fc3d4
      amd64: 020468de7539ce70ef1bceaf7cde2e8c4f2ca6c3afb84642aabc5c97d9fc2a0d
  kind:
    darwin:
      arm64: 2628c53ddf4a2de19950df0452176e400e33b8c83834afab93651c2b6f9546bd
      amd64: 32bd46859a98bffdfc2e594850c4147d297b3f93007f8376b6d4a28e82dee29a
    linux:
      arm64: 1326f87d766e6108c4e140238b55a588721ea612c3ab2c242ed291da3d9f7608
      amd64: b543dca8440de4273be19ad818dcdfcf12ad1f767c962242fcccdb383dff893b
  kubectl:
    darwin:
      arm64: 2b000dded317319b1ebca19c2bc70f772c7aaa0e8962fae2d987ba04dd1a1b50
      amd64: 07a04d82bc2de2f5d53dfd81f2109ca864f634a82b225257daa2f9c2db15ccef
    linux:
      arm64: 706256e21a4e9192ee62d1a007ac0bfcff2b0b26e92cc7baad487a6a5d08ff82
      amd64: 36e2f4ac66259232341dd7866952d64a958846470f6a9a6a813b9117bd965207
  saml2aws:
    darwin:
      arm64: 2554c38ed8d0a92902943e6623ef16223e6e8536978c2bfc3301f7e6fc9b7eab
      amd64: ca04b5a67ea852315c9c66acd460cb0501d7fac9aa345e86f1179ccec7c6f0c7
    linux:
      arm64: 039477d1bdbff940e5de067e7a56ab48dcf5303869ff4b74da9d1a5a87d9ac7b
      amd64: ca8ec4da5566bef409c8c582da3cf9f22a8d5e18f7dcba25aeb9670f1ea98980
  shellcheck:
    darwin:
      aarch64: 61c17246d69f012cd458ae82f244c46023dac75d1b69733ca1cc7d28fb270fd7
      x86_64: 2589be755bb115f4421b8271eb7c08df1e03729f00350c1e4cf53b4a0bf9c2df
    linux:
      aarch64: 127f13925eadd52c341bca0ebaf9ab0dbd78c6468f30a8f262a528bf8de47546
      x86_64: 4da528ddb3a4d1b7b24a59d4e16eb2f5fd960f4bd9a3708a15baddbdf1d5a55b
  yq:
    darwin:
      arm64: 34613ea97c4c77e1894a8978dbf72588d187a69a6292c10dab396c767a1ecde7
      amd64: 54a63555210e73abed09108097072e28bf82a6bb20439a72b55509c4dd42378d
    linux:
      arm64: c82856ac30da522f50dcdd4f53065487b5a2927e9b87ff637956900986f1f7c2
      amd64: a74bd266990339e0c48a2103534aef692abf99f19390d12c2b0ce6830385c459
  codeowners:
    darwin:
      arm64: 4dd03300edb5116a96c760804780e5bc2f866cddda75030baa7f2e5451edaaf4
      amd64: 3eccd5ed9a09de0483cc418ffe40a8bdef278fb94aa63c14de5bf70e4eb45f5c
    linux:
      arm64: b49ff0dae28b64290e31bb0b5d7d905089a54ffb5bde40a1dcb40fc1a024de65
      amd64: f5fa73add8f5d705f320a027bcfbb2d30dbbbf3ad928d3fc6dc8bb38e521417e
  woke:
    darwin:
      arm64: f701db4253208699ddfccd70041d9eec41c240f527c3786ae21ecdf8504a26ab
      amd64: 887f8e5dcf1e2c120deb1e4d555a2cc488d5f150b5a3bbb505ad914867f69fdd
    linux:
      arm64: e3e0ea487f0f42c236c0532af963dbc6818ecf6c417f3a1b7c75a805cf846aa5
      amd64: 41bb1f5d9329d964d43ceaab913fdf7350f836cbea8f6b468ee04fed8fc7e701
  download-utilities.sh: 61daa8e38f68f45c1bb8b7eaecd383e6afa6172f2543af24352358e2f1ffeea2

# These utilities are installed by
# https://github.com/samrocketman/yml-install-files
defaults: &defaults
  # dest could be /usr/local/bin in Docker builds
  dest: usr/bin
  perm: '0755'
  checksum_file: checksums/$(uname)-$(arch).sha256
  os:
    Linux: linux
    Darwin: darwin
  arch:
    x86_64: amd64
    aarch64: arm64
  pre_command: |
    if [ ! "${inline_checksum:-false}" = true ]; then
      if [ ! "$HOME" = "$PWD" ]; then
        echo 'ERROR: this must run from the HOME.' >&2
        exit 5
      fi
      if [ "$USER" = root ]; then
        echo 'ERROR: this must run as a normal user.' >&2
        exit 5
      fi
    fi
    if [ "${checksum_failed:-true}" = true ]; then
      rm -f ${dest}/${utility}
    fi
  update: |
    case "${download}" in
      https://github.com/*)
        owner="$(awk -F/ '{print $4"/"$5}' <<< "${download}")"
        export download=https://github.com/"${owner}"/releases/latest
        eval "${default_download_head}" |
        awk '$1 ~ /[Ll]ocation:/ { gsub(".*/[^0-9.]*", "", $0); print;exit}'
        ;;
      https://dl.k8s.io/release*)
        download=https://dl.k8s.io/release/stable.txt
        extract=cat
        export download extract
        eval "${default_download_extract}" |
        awk '{gsub("v", "", $0); print}'
        ;;
      https://get.helm.sh/*)
        export download=https://github.com/helm/helm/releases/latest
        eval "${default_download_head}" |
        awk '$1 ~ /[Ll]ocation:/ { gsub(".*/[^0-9.]*", "", $0); print;exit}'
        ;;
    esac
utility:
  codeowners:
    <<: *defaults
    download: https://github.com/hmarr/codeowners/releases/download/v${version}/codeowners_${version}_${os}_${arch}.tar.gz
    extract: tar -xzC ${dest}/ --no-same-owner ${utility}
  crane:
    <<: *defaults
    # Darwin and Linux
    os:
    # x86_64 and arm64
    arch:
      aarch64: arm64
    download: https://github.com/google/go-containerregistry/releases/download/v${version}/go-containerregistry_${os}_${arch}.tar.gz
    extract: tar -xzC ${dest}/ --no-same-owner ${utility}
  docker-buildx:
    <<: *defaults
    download: https://github.com/docker/buildx/releases/download/v${version}/buildx-v${version}.${os}-${arch}
    post_command: |
      [ -d ~/.docker/cli-plugins ] || mkdir -p ~/.docker/cli-plugins
      ln -fs "${HOME}/${dest}/${utility}" ~/.docker/cli-plugins/
  docker-compose:
    <<: *defaults
    # x86_64 and aarch64 are the two supported architectures.
    arch:
      arm64: aarch64
    download: https://github.com/docker/compose/releases/download/v${version}/docker-compose-${os}-${arch}
    post_command: |
      [ -d ~/.docker/cli-plugins ] || mkdir -p ~/.docker/cli-plugins
      ln -fs "${HOME}/${dest}/${utility}" ~/.docker/cli-plugins/
  download-utilities.sh:
    <<: *defaults
    download: https://github.com/samrocketman/yml-install-files/releases/download/v${version}/universal.tgz
    extract: tar -xzC ${dest}/ --no-same-owner ${utility}
  gh:
    <<: *defaults
    os:
      Linux: linux
      Darwin: macOS
    extension:
      default: tar.gz
      macOS: zip
    default_download_extract: |
      trap '[ ! -f /tmp/file.zip ] || rm -f /tmp/file.zip' EXIT
      if type -P curl; then
        curl -sSfL ${download} | ${extract}
      else
        wget -q -O - ${download} | ${extract}
      fi
    extract:
      macOS: |
        {
          cat > /tmp/file.zip
          unzip -o -j -d ${dest} /tmp/file.zip '*/bin/gh'
        }
      linux: tar -xzC ${dest}/ --no-same-owner --strip-components=2 gh_${version}_${os}_${arch}/bin/gh
    download: https://github.com/cli/cli/releases/download/v${version}/gh_${version}_${os}_${arch}.${extension}
  git-idm:
    <<: *defaults
    download: https://raw.githubusercontent.com/samrocketman/git-identity-manager/${version}/git-idm
    update: >
      git ls-remote https://github.com/samrocketman/git-identity-manager.git |
      awk '$2 == "refs/heads/main" {print $1;exit}'
  gitleaks:
    <<: *defaults
    arch:
      x86_64: x64
      aarch64: arm64
    download: https://github.com/gitleaks/gitleaks/releases/download/v${version}/gitleaks_${version}_${os}_${arch}.tar.gz
    extract: tar -xzC ${dest}/ --no-same-owner ${utility}
  goss:
    <<: *defaults
    download: https://github.com/goss-org/goss/releases/download/v${version}/goss-${os}-${arch}
  jq:
    <<: *defaults
    os:
      Linux: linux
      Darwin: macos
    download: https://github.com/jqlang/jq/releases/download/jq-${version}/jq-${os}-${arch}
  kind:
    <<: *defaults
    download: https://github.com/kubernetes-sigs/kind/releases/download/v0.19.0/kind-${os}-${arch}
  kubectl:
    <<: *defaults
    download: https://dl.k8s.io/release/v${version}/bin/${os}/${arch}/kubectl
  saml2aws:
    <<: *defaults
    extract: tar -xzC ${dest}/ --no-same-owner ${utility}
    download: https://github.com/Versent/saml2aws/releases/download/v${version}/saml2aws_${version}_${os}_${arch}.tar.gz
  shellcheck:
    <<: *defaults
    arch:
      Darwin:
        arm64: aarch64
        i386: x86_64
    download: https://github.com/koalaman/shellcheck/releases/download/v${version}/shellcheck-v${version}.${os}.${arch}.tar.xz
    extract: tar -xJC ${dest}/ --no-same-owner --strip-components=1 ${utility}-v${version}/${utility}
  woke:
    <<: *defaults
    download: https://github.com/get-woke/woke/releases/download/v${version}/woke-${version}-${os}-${arch}.tar.gz
    extract: tar -xzC ${dest}/ --no-same-owner --strip-components=1 "${utility}-${version}-${os}-${arch}/${utility}"
  yq:
    <<: *defaults
    download: https://github.com/mikefarah/yq/releases/download/v${version}/yq_${os}_${arch}
