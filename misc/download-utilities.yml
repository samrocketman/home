versions:
  crane: 0.20.2
  docker-buildx: 0.17.1
  docker-compose: 2.29.3
  download-utilities.sh: "3.1"
  gh: 2.56.0
  git-idm: 68c2ee1e406c2f2c72c8399e09564a970a025a0a
  gitleaks: 8.19.1
  goss: 0.4.8
  jq: 1.7.1
  kind: 0.24.0
  kubectl: 1.31.0
  saml2aws: 2.36.17
  yq: 4.44.3
checksums:
  crane:
    Darwin:
      arm64: 75096fc14f72346ce336ef67cd152600043ca7a6f59dab38ea3dec6366a975c1
      x86_64: f296b50ae5cde7882e0c5b9de3b3be949e047ab6eca4c4dc9c0c6cd089dc38ea
    Linux:
      arm64: 1dd7affc6f3e65b3f2d4b2ceed85f2b23bcf6d2165b962c9040d5a2e5ca5a23e
      x86_64: 7e00f53d871214a6eff6f67eef434745af6fd5e1c04fb563df37b93cc352f8c1
  docker-buildx:
    darwin:
      arm64: 6f01a55c66edb9bc6f03c035c17f640b0edd672f2fcf0e7389440cc51c403517
      amd64: bb285f84661af4be2c09a94a9e4045edcdb67e056bcc6149eadf4845f3a49fce
    linux:
      arm64: de05dccd47932eb9fd6e63781ab29d2b0b2c834bbdd19b51d7ea452b1fe378d3
      amd64: aa7a9778349e1a8ace685e4c51a1d33e7a9b0aa6925d1c625b09cb3800eba696
  docker-compose:
    darwin:
      aarch64: cf032a3c1cdff87a4f3dd0136ae334a8f88e6f0f277ebf996bce796342c83c45
      x86_64: 5f5d7d527755fafca3e3f1952b966bc88206c4e16d3a3307bdedce3ffa245dfc
    linux:
      aarch64: 10ded2b3b02b15957b1650b99d1e5ff216d882c5203a563d0aa7a87580a0d8ca
      x86_64: 241b75fe0f8194a48d01f99d683aa1100579b21caa60d2d78c9c824855c57937
  download-utilities.sh: 23a9abea402078e27e0250a29830fb65feff7d9beeb99b3a275900aa8404a004
  gh:
    macOS:
      arm64: 971a1e10f244519c1582389ae3a91f17e2af8c87ac78eeaeb980c4feed9b4901
      amd64: 5f22dcca7b3e3bd30f45ae86f12917efe893fed769826f35846e3e6c92a63e7e
    linux:
      arm64: bc5547caf1a8b7ab0e4064e46bd7406cfc6b3721b28f49e0a38a731135b78804
      amd64: 7edb416a89fef4781a7284a2be056636efd7791811562072f132e52bd48b9b80
  git-idm: d99592623838932190083cd1f2c8bc47af9f97e8fa4b6dab580c80830d4e2071
  gitleaks:
    darwin:
      arm64: 06c1aa4f87664edac2906adbaa72463df459fd9ae7a03f8e5897d4ebd80c433b
      x64: 1f5a9ee977c45374b985c8aee028ae0bfac3cc6b6ec11ff528ef26adb515e370
    linux:
      arm64: bb447738c0bdadd7b1c6b051d725ca590a7bedb485cc065b1e8ed57091ef602b
      x64: 1cc91ad903d82353b01f45aa31fd27e1e14f3b586acf30aa531fdb73d5bc99ce
  goss:
    darwin:
      arm64: 67e45546baf9d7cae862506409225a5f6f3c0dd7f33ada6bc1c8ebb125b5cfa9
      amd64: acbec7d486966d67407c514fd129c5c83fa27eb2aa7cb8b4c83ff616c4a40439
    linux:
      arm64: bca8c898bfd35b94c51455ece6193c95e2cd7b2b183ac2047b2d76291e73e47d
      amd64: 85d00b7bba5f175bec95de7dfe1f71f8f25204914aad4c6f03c8457868eb6e2f
  jq:
    macos:
      arm64: 0bbe619e663e0de2c550be2fe0d240d076799d6f8a652b70fa04aea8a8362e8a
      amd64: 4155822bbf5ea90f5c79cf254665975eb4274d426d0709770c21774de5407443
    linux:
      arm64: 4dd2d8a0661df0b22f1bb9a1f9830f06b6f3b8f7d91211a1ef5d7c4f06a8b4a5
      amd64: 5942c9b0934e510ee61eb3e30273f1b3fe2590df93933a93d7c58b81d19c8ff5
  kind:
    darwin:
      arm64: 2628c53ddf4a2de19950df0452176e400e33b8c83834afab93651c2b6f9546bd
      amd64: 32bd46859a98bffdfc2e594850c4147d297b3f93007f8376b6d4a28e82dee29a
    linux:
      arm64: 1326f87d766e6108c4e140238b55a588721ea612c3ab2c242ed291da3d9f7608
      amd64: b543dca8440de4273be19ad818dcdfcf12ad1f767c962242fcccdb383dff893b
  kubectl:
    darwin:
      arm64: b7472df17a885574ed7273947a8a274c156357db21b981208e8e109b9ed4022d
      amd64: fb6e07a69acc4e16885eda55b524c13b84bfbcf78cfac8d6c378d2bad321e105
    linux:
      arm64: f42832db7d77897514639c6df38214a6d8ae1262ee34943364ec1ffaee6c009c
      amd64: 7c27adc64a84d1c0cc3dcf7bf4b6e916cc00f3f576a2dbac51b318d926032437
  saml2aws:
    darwin:
      arm64: 144f47396f212f487f69de9c89cc933fb6a34fa9990370da2ef368ff634fa838
      amd64: d15570519fa236dd5a65db2dafc43162dc4e2d02b41e5ff1966b47a810048960
    linux:
      arm64: 19739d6ab5319e6171e36c9ca8f0c54ba74b39b1a021dbcc0236b43471f6b743
      amd64: a87fcef766a843ca4fabfac1160fbb957084723b95d84ed51544bcd6ebbaef92
  yq:
    darwin:
      arm64: 559a594ef7a6ebc5b81a67b7717fb3accedd266d8fa7d8352da7fec9e463f48b
      amd64: 216ddfa03e7ba0e5aba00b236ec78324b5bfc49b610db254fe92310878baea20
    linux:
      arm64: 0e7e1524f68d91b3ff9b089872d185940ab0fa020a5a9052046ef10547023156
      amd64: a2c097180dd884a8d50c956ee16a9cec070f30a7947cf4ebf87d5f36213e9ed7

# These utilities are installed by
# https://github.com/samrocketman/yml-install-files
defaults: &defaults
  # dest could be /usr/local/bin in Docker builds
  dest: usr/bin
  perm: '0755'
  checksum_file: checksums/$(uname)-$(arch).sha256
  os:
    Linux: linux
    Darwin: darwin
  arch:
    x86_64: amd64
    aarch64: arm64
  pre_command: |
    if [ ! "${inline_checksum:-false}" = true ]; then
      if [ ! "$HOME" = "$PWD" ]; then
        echo 'ERROR: this must run from the HOME.' >&2
        exit 5
      fi
      if [ "$USER" = root ]; then
        echo 'ERROR: this must run as a normal user.' >&2
        exit 5
      fi
    fi
    if [ "${checksum_failed:-true}" = true ]; then
      rm -f ${dest}/${utility}
    fi
  update: |
    case "${download}" in
      https://github.com/*)
        owner="$(awk -F/ '{print $4"/"$5}' <<< "${download}")"
        export download=https://github.com/"${owner}"/releases/latest
        eval "${default_download_head}" |
        awk '$1 ~ /[Ll]ocation:/ { gsub(".*/[^0-9.]*", "", $0); print;exit}'
        ;;
      https://dl.k8s.io/release*)
        download=https://dl.k8s.io/release/stable.txt
        extract=cat
        export download extract
        eval "${default_download_extract}" |
        awk '{gsub("v", "", $0); print}'
        ;;
      https://get.helm.sh/*)
        export download=https://github.com/helm/helm/releases/latest
        eval "${default_download_head}" |
        awk '$1 ~ /[Ll]ocation:/ { gsub(".*/[^0-9.]*", "", $0); print;exit}'
        ;;
    esac
utility:
  crane:
    <<: *defaults
    # Darwin and Linux
    os:
    # x86_64 and arm64
    arch:
      aarch64: arm64
    download: https://github.com/google/go-containerregistry/releases/download/v${version}/go-containerregistry_${os}_${arch}.tar.gz
    extract: tar -xzC ${dest}/ --no-same-owner ${utility}
  docker-buildx:
    <<: *defaults
    download: https://github.com/docker/buildx/releases/download/v${version}/buildx-v${version}.${os}-${arch}
    post_command: |
      if [ ! -L ~/.docker/cli-plugins/${utility} ]; then
        mkdir -p ~/.docker/cli-plugins
        ln -fs "${HOME}/${dest}/${utility}" ~/.docker/cli-plugins/
      fi
  docker-compose:
    <<: *defaults
    # x86_64 and aarch64 are the two supported architectures.
    arch:
      arm64: aarch64
    download: https://github.com/docker/compose/releases/download/v${version}/docker-compose-${os}-${arch}
    post_command: |
      if [ ! -L ~/.docker/cli-plugins/${utility} ]; then
        ln -fs "${HOME}/${dest}/${utility}" ~/.docker/cli-plugins/
      fi
  download-utilities.sh:
    <<: *defaults
    download: https://github.com/samrocketman/yml-install-files/releases/download/v${version}/universal.tgz
    extract: tar -xzC ${dest}/ --no-same-owner ${utility}
  gh:
    <<: *defaults
    os:
      Linux: linux
      Darwin: macOS
    extension:
      default: tar.gz
      macOS: zip
    default_download_extract: |
      trap '[ ! -f /tmp/file.zip ] || rm -f /tmp/file.zip' EXIT
      if type -P curl; then
        curl -sSfL ${download} | ${extract}
      else
        wget -q -O - ${download} | ${extract}
      fi
    extract:
      macOS: |
        {
          cat > /tmp/file.zip
          unzip -o -j -d ${dest} /tmp/file.zip '*/bin/gh'
        }
      linux: tar -xzC ${dest}/ --no-same-owner --strip-components=2 gh_${version}_${os}_${arch}/bin/gh
    download: https://github.com/cli/cli/releases/download/v${version}/gh_${version}_${os}_${arch}.${extension}
  git-idm:
    <<: *defaults
    download: https://raw.githubusercontent.com/samrocketman/git-identity-manager/${version}/git-idm
    update: >
      git ls-remote https://github.com/samrocketman/git-identity-manager.git |
      awk '$2 == "refs/heads/main" {print $1;exit}'
  gitleaks:
    <<: *defaults
    arch:
      x86_64: x64
      aarch64: arm64
    download: https://github.com/gitleaks/gitleaks/releases/download/v${version}/gitleaks_${version}_${os}_${arch}.tar.gz
    extract: tar -xzC ${dest}/ --no-same-owner ${utility}
  goss:
    <<: *defaults
    download: https://github.com/goss-org/goss/releases/download/v${version}/goss-${os}-${arch}
  jq:
    <<: *defaults
    os:
      Linux: linux
      Darwin: macos
    download: https://github.com/jqlang/jq/releases/download/jq-${version}/jq-${os}-${arch}
  kind:
    <<: *defaults
    download: https://github.com/kubernetes-sigs/kind/releases/download/v0.19.0/kind-${os}-${arch}
  kubectl:
    <<: *defaults
    download: https://dl.k8s.io/release/v${version}/bin/${os}/${arch}/kubectl
  saml2aws:
    <<: *defaults
    extract: tar -xzC ${dest}/ --no-same-owner ${utility}
    download: https://github.com/Versent/saml2aws/releases/download/v${version}/saml2aws_${version}_${os}_${arch}.tar.gz
  yq:
    <<: *defaults
    download: https://github.com/mikefarah/yq/releases/download/v${version}/yq_${os}_${arch}
